{
  "nftables": [
    {
      "metainfo": {
        "version": "1.1.1",
        "release_name": "Commodore Bullmoose #2",
        "json_schema_version": 1
      }
    },
    {
      "chain": {
        "family": "inet",
        "table": "flowspecs",
        "name": "flowspecs",
        "handle": 1
      }
    },
    {
      "rule": {
        "family": "inet",
        "table": "flowspecs",
        "chain": "flowspecs",
        "handle": 2,
        "comment": "0",
        "expr": [
          {
            "match": {
              "op": "==",
              "left": {
                "meta": {
                  "key": "nfproto"
                }
              },
              "right": 10
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "protocol": "th",
                  "field": "dport"
                }
              },
              "right": 50
            }
          }
        ]
      }
    },
    {
      "rule": {
        "family": "inet",
        "table": "flowspecs",
        "chain": "flowspecs",
        "handle": 3,
        "comment": "1",
        "expr": [
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "protocol": "ip6",
                  "field": "daddr"
                }
              },
              "right": "fec0:1122:3344:5566:7788:99aa:bbcc:ddee"
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "&": [
                  {
                    "payload": {
                      "base": "nh",
                      "offset": 248,
                      "len": 8
                    }
                  },
                  1
                ]
              },
              "right": 1
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "base": "nh",
                  "offset": 256,
                  "len": 32
                }
              },
              "right": 305419896
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "base": "nh",
                  "offset": 288,
                  "len": 8
                }
              },
              "right": 152
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "protocol": "th",
                  "field": "dport"
                }
              },
              "right": 60
            }
          },
          {
            "match": {
              "op": "!=",
              "left": {
                "exthdr": {
                  "name": "frag",
                  "field": "frag-off"
                }
              },
              "right": 0
            }
          },
          {
            "limit": {
              "rate": 115,
              "burst": 0,
              "per": "second",
              "inv": true,
              "rate_unit": "bytes",
              "burst_unit": "bytes"
            }
          },
          {
            "drop": null
          }
        ]
      }
    },
    {
      "rule": {
        "family": "inet",
        "table": "flowspecs",
        "chain": "flowspecs",
        "handle": 4,
        "comment": "1",
        "expr": [
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "protocol": "ip6",
                  "field": "daddr"
                }
              },
              "right": "fec0:1122:3344:5566:7788:99aa:bbcc:ddee"
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "&": [
                  {
                    "payload": {
                      "base": "nh",
                      "offset": 248,
                      "len": 8
                    }
                  },
                  1
                ]
              },
              "right": 1
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "base": "nh",
                  "offset": 256,
                  "len": 32
                }
              },
              "right": 305419896
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "base": "nh",
                  "offset": 288,
                  "len": 8
                }
              },
              "right": 152
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "protocol": "th",
                  "field": "dport"
                }
              },
              "right": 60
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "exthdr": {
                  "name": "frag",
                  "field": "frag-off"
                }
              },
              "right": 0
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "exthdr": {
                  "name": "frag",
                  "field": "more-fragments"
                }
              },
              "right": 1
            }
          },
          {
            "limit": {
              "rate": 115,
              "burst": 0,
              "per": "second",
              "inv": true,
              "rate_unit": "bytes",
              "burst_unit": "bytes"
            }
          },
          {
            "drop": null
          }
        ]
      }
    },
    {
      "rule": {
        "family": "inet",
        "table": "flowspecs",
        "chain": "flowspecs",
        "handle": 5,
        "comment": "1",
        "expr": [
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "protocol": "ip6",
                  "field": "daddr"
                }
              },
              "right": "fec0:1122:3344:5566:7788:99aa:bbcc:ddee"
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "&": [
                  {
                    "payload": {
                      "base": "nh",
                      "offset": 248,
                      "len": 8
                    }
                  },
                  1
                ]
              },
              "right": 1
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "base": "nh",
                  "offset": 256,
                  "len": 32
                }
              },
              "right": 305419896
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "base": "nh",
                  "offset": 288,
                  "len": 8
                }
              },
              "right": 152
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "protocol": "th",
                  "field": "dport"
                }
              },
              "right": 60
            }
          },
          {
            "match": {
              "op": "!=",
              "left": {
                "exthdr": {
                  "name": "frag",
                  "field": "frag-off"
                }
              },
              "right": 0
            }
          },
          {
            "accept": null
          }
        ]
      }
    },
    {
      "rule": {
        "family": "inet",
        "table": "flowspecs",
        "chain": "flowspecs",
        "handle": 6,
        "comment": "1",
        "expr": [
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "protocol": "ip6",
                  "field": "daddr"
                }
              },
              "right": "fec0:1122:3344:5566:7788:99aa:bbcc:ddee"
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "&": [
                  {
                    "payload": {
                      "base": "nh",
                      "offset": 248,
                      "len": 8
                    }
                  },
                  1
                ]
              },
              "right": 1
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "base": "nh",
                  "offset": 256,
                  "len": 32
                }
              },
              "right": 305419896
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "base": "nh",
                  "offset": 288,
                  "len": 8
                }
              },
              "right": 152
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "payload": {
                  "protocol": "th",
                  "field": "dport"
                }
              },
              "right": 60
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "exthdr": {
                  "name": "frag",
                  "field": "frag-off"
                }
              },
              "right": 0
            }
          },
          {
            "match": {
              "op": "==",
              "left": {
                "exthdr": {
                  "name": "frag",
                  "field": "more-fragments"
                }
              },
              "right": 1
            }
          },
          {
            "accept": null
          }
        ]
      }
    }
  ]
}
